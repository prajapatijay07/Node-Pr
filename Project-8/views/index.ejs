<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Myntra Clone</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

  <style>
    body {
      font-family: "Assistant", -apple-system, BlinkMacSystemFont, Segoe UI, Roboto;
      background: #fff;
      color: #282c3f;
    }

    /* HEADER */
    header {
      background: #fff;
      border-bottom: 1px solid #eaeaec;
      position: sticky;
      top: 0;
      z-index: 1000;
      overflow: visible !important;
    }

    /* header .container{
  overflow: visible !important;
} */

    .logo-img {
      height: 40px;
      width: auto;
      object-fit: contain;
    }

    /* NAV */
    .navbar-menu a {
      font-weight: 700;
      font-size: 14px;
      margin: 0 14px;
      padding-bottom: 20px;
      text-decoration: none;
      color: #282c3f;
      padding-top: 20px;
    }

    .navbar-menu a:hover {
      border-bottom: 3px solid #ff3f6c;
    }

    /* SEARCH */
    .search-box {
      position: relative;
    }

    .search-box input {
      width: 100%;
      padding: 10px 40px;
      background: #f5f5f6;
      border: none;
      border-radius: 4px;
    }

    .search-box i {
      position: absolute;
      top: 12px;
      left: 14px;
      color: #94969f;
    }

    /* ICONS */
    .nav-icons {
      display: flex;
      gap: 20px;
      font-size: 12px;
    }

    .nav-icons a {
      color: #282c3f;
      text-decoration: none;
      text-align: center;
    }

    .nav-icons i {
      display: block;
      font-size: 18px;
    }

    /* PROFILE DROPDOWN */
    .profile {
      position: relative;
    }

    .profile-menu {
      display: none;
      position: absolute;
      right: 0;
      top: 100%;
      background: #fff;
      width: 200px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, .1);
      padding: 15px;
      opacity: 0;
      visibility: hidden;
      transition: 0.2s ease;
    }

    .profile:hover .profile-menu {
      display: block;
      opacity: 1;
      visibility: visible;
    }

    .profile-menu a {
      display: block;
      margin: 8px 0;
      font-size: 14px;
      color: #282c3f;
      text-decoration: none;
    }

    .login-btn {
      border: 1px solid #ff3f6c;
      color: #ff3f6c;
      text-align: center;
      padding: 8px;
      font-weight: 700;
    }

    /* CATEGORY BAR */
    .category-bar {
      text-align: center;
      padding: 10px 0;
      background-color: #f3f4f7;
    }

    .category-bar a {
      margin: 0 12px;
      font-weight: 700;
      text-decoration: none;
      color: #282c3f;
      padding-bottom: 6px;
    }

    .category-bar a.active,
    .category-bar a:hover {
      color: #ff3f6c;
      border-bottom: 3px solid #ff3f6c;
    }

    /* PRODUCT CARD */
    .product-card {
      position: relative;
      overflow: hidden;
      cursor: pointer;
    }

    .product-card img {
      width: 100%;
      height: 280px;
      object-fit: cover;
      transition: 0.3s ease;
      display: block;
    }

    /* DARK OVERLAY */
    .product-card::after {
      content: "";
      position: absolute;
      inset: 0;
      opacity: 0;
      transition: 0.3s ease;
      z-index: 1;
    }

    .product-card:hover::after {
      opacity: 1;
    }

    /* VIEW DETAILS BUTTON */
    .view-details-btn {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #ff3f6c;
      color: #fff;
      padding: 10px 18px;
      font-size: 13px;
      font-weight: 700;
      border-radius: 4px;
      text-decoration: none;
      opacity: 0;
      visibility: hidden;
      transition: 0.3s ease;
      z-index: 2;
    }

    .product-card:hover .view-details-btn {
      opacity: 1;
      visibility: visible;
    }

    .product-card:hover img {
      transform: scale(1.05);
    }

    /* PRODUCT INFO */
    .product-info {
      padding-top: 8px;
    }

    .product-name {
      font-size: 14px;
      font-weight: 700;
    }

    .product-desc {
      font-size: 13px;
      color: #94969f;
    }

    .product-price {
      font-weight: 800;
      margin-top: 4px;
    }


    /* PAGINATION */
    .pagination a {
      font-weight: 700;
      color: #282c3f;
      text-decoration: none;
    }

    .pagination a.active {
      color: #ff3f6c;
    }

    /* FOOTER */
    footer {
      background: #fafbfc;
      padding: 40px 0;
      color: #94969f;
      font-size: 14px;
      margin-top: 60px;
    }
  </style>
</head>

<body>

  <header>
    <div class="container d-flex align-items-center py-2">

      <a href="/user" class="me-4">
        <img src="/assets/myntra.jpeg" alt="Myntra" class="logo-img">
      </a>


      <div class="navbar-menu d-none d-md-flex">
        <a href="#">MEN</a>
        <a href="#">WOMEN</a>
        <a href="#">KIDS</a>
        <a href="#">HOME</a>
        <a href="#">BEAUTY</a>
      </div>

      <form method="get" action="/user" class="search-box flex-grow-1 mx-4">
        <i class="fa fa-search"></i>
        <input type="text" name="search" placeholder="Search for products, brands and more" value="<%= search || '' %>">
        <% if(category){ %>
          <input type="hidden" name="category" value="<%= category %>">
          <% } %>
      </form>

      <div class="nav-icons">
        <div class="profile">
          <a href="#"><i class="fa-regular fa-user"></i>Profile</a>
          <div class="profile-menu">

            <% if(!userData){ %>
              <strong>Hello Guest</strong>
              <a href="/user/loginUser" class="login-btn">LOGIN / SIGNUP</a>
              <% } else { %>
                <strong>Hello <%= userData.username %></strong>
                <a href="/user/view-profile">My Profile</a>
                <a href="/user/change-password">Change Password</a>
                <a href="/user/logoutUser">Logout</a>
                <% } %>

          </div>

        </div>
        <a href="/user/favourite" style="position:relative">
          <i class="fa-regular fa-heart"></i>Wishlist
          <% if(favCount> 0){ %>
            <span class="badge bg-danger position-absolute top-0 start-100 translate-middle">
              <%= favCount %>
            </span>
            <% } %>
        </a>

        <a href="/user/cart" style="position:relative">
          <i class="fa-solid fa-bag-shopping"></i>Bag
          <% if(cartCount> 0){ %>
            <span class="badge bg-danger position-absolute top-0 start-100 translate-middle">
              <%= cartCount %>
            </span>
            <% } %>
        </a>

      </div>
    </div>

    <div class="category-bar">
      <a href="/user" class="<%= !category?'active':'' %>">ALL</a>
      <% categories.forEach(cat=>{ %>
        <a href="/user?category=<%= cat._id %>" class="<%= category==cat._id.toString()?'active':'' %>">
          <%= cat.category %>
        </a>
        <% }) %>
    </div>
  </header>

  <div class="container my-5">
    <div class="row g-4">
      <% if(allProducts.length>0){ %>
        <% allProducts.forEach(product=>{ %>
          <div class="col-6 col-md-3">
  <div class="product-card">

    <img src="<%= product.productImage || 'https://via.placeholder.com/300x400?text=No+Image' %>">

    <!-- VIEW DETAILS (PERFECT POSITION) -->
    <a href="/user/single-product/<%= product._id %>" class="view-details-btn">
      VIEW DETAILS
    </a>

    <div class="product-info">
      <div class="product-name">
        <%= product.productName || 'No Name' %>
      </div>

      <div class="product-desc">
        <%= product.description ? product.description.substring(0,40) : 'No description available' %>
      </div>

      <div class="product-price">
        ₹<%= product.price || 0 %>
      </div>

      <div style="font-size:12px;color:#94969f;margin-top:4px;">
        Category: <%= product.categoryId?.category || 'N/A' %>
      </div>

      <div style="font-size:12px;color:#94969f;">
        Sub: <%= product.subCategoryId?.subCategory || 'N/A' %>
      </div>

      <div style="font-size:12px;color:#94969f;">
        Extra: <%= product.extraCategoryId?.extraCategory || 'N/A' %>
      </div>
    </div>

  </div>
</div>

          <% }) %>
            <% } else { %>
              <p class="text-center text-muted">No products found</p>
              <% } %>
    </div>

    <div class="pagination justify-content-center mt-4">
      <% for(let i=1;i<=totalPages;i++){ %>
        <a href="/user?page=<%= i %>" class="<%= i===currentPage?'active':'' %> mx-2">
          <%= i %>
        </a>
        <% } %>
    </div>
  </div>

  <footer>
    <div class="container text-center">
      © <%= new Date().getFullYear() %> Myntra Clone
    </div>
  </footer>

</body>

</html>